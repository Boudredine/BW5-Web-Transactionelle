# TP2


## Terminez de mettre en place **i18n**
#### Ce qui est déjà fait :
   - Les packages nuget sont installés
   - Les **vues** sont déjà traduites!
   - Les **modèles** aussi!
   - Le Inject du **IViewLocalizer** est aussi déjà présent

#### Ce qu’il faut faire :
   - Il faut configurer **i18n** dans **Program.cs**. Les fichiers de traduction **resx** se trouvent dans le répertoire **/i18n/**
   - Il faut ajouter une fonction **SetLanguage** au **HomeController**
   - Finalement, Il manque le commutateur de langue dans le **_Layout**. Utilisez une vue partielle et nommez-la **_SelectLanguage**

<CommentCommitPush/>

## Faites fonctionner le filtre
1. Implémentez la fonction Filter du TrainerController
2. Implémenter la méthode **GetAllAsync** du service **TrainerService** pour prendre en compte les paramètres de pagination de **TrainerSearchViewModelFilter**
3. Dans la même méthode, il faut également ajouter des **Where** pour filtrer selon chacun des critères de recherche de **TrainerSearchViewModelFilter**

:::info

Voici comment faire une requête pour une condition optionnelle dans Linq et ne filtrer que lorsque l'on sélectionne une valeur dans le filtre. 

:::

```csharp

.Where(x=> filter.SelectedCategoryId == null || x.CategoryId == filter.SelectedCategoryId ).ToList() 

```

<CommentCommitPush/>

## Affichez le détail d'un **Trainer** dans la page **Trainer/Index**
1. Écrivez du javascript pour ajouter la classe **show** à l’élément enfant **aside** lorsqu'on survole le **card** d’un entraîneur.
2. Écrivez du javascript pour retirer la classe **show** à l’élément enfant **aside** lorsqu'on ne survole plus le **card**.

:::info

 Comme **aside** est un enfant de **card**, si l'utilisateur bouge sa souris à l'extérieur de la photo de l'entraîneur vers le **aside**, la souris est toujours techniquement au dessus de **card** et ça ne cause pas d'évênement **onmouseout**. **Ça tombe bien, c'est exactement ce que l'on veut!**

:::

## Faire fonctionner la pagination

1. Il faut maintenant utiliser **Items** du modèle **TrainerSearchViewModel** qui est un **IPagniatedList&ltTrainer&gt** pour bien afficher les liens de navigations
2. Mettez le code pour que l’ensemble des pages disponibles soient affichées dans la pagination.
3. Ajoutez la logique que Previous et Next fonctionnent et s'affichent lorsque nécessaire. 

![Image Reference](/tps/tp2/navigation.png)

4. Ajoutez le javascript pour que quand on clique sur les éléments de pagination, que la page change dans le filtre du formulaire et qu'il se soumette automatiquement. Utilisez les attributs **data-page-id** qui sont déjà là.
5. Mettre le **SelectedPageIndex** sur le formulaire en **type="hidden"** et supprimez le libellé.
 


## Notes
Notes sur le TP2 originale:

(Note generale: la navigation dans les autres pages semblent weird (c'est pas claire comment les certifications fonctionnent...))
(Quand on affiche la page pour editer un Trainer, le footer cache le contenu!)
(Si on est deja sur un index, quand on filtre, ca ne reset pas l'index a zero... on peut donc se retrouver sur un index qui n'existe pas avec le filtre courrant)
(Microsot.AspNetCore.Mvc.Localization 2.2.0 est deprecated)
(Le popup JS est uniquement en anglais...)


5. Générez les vues et contrôleur (RecordController) du modèle Record. 
   - Modifier la vue Record/Index afin d’afficher les noms des éléments au lieu de leurs descriptions (ex. Trainer, il va prendre Bibliography). 
   - Mettre le code/librairies permettant d’éditer les décimales pour que l’édition et la création du montant fonctionne en français.
   - Complétez la traduction du modèle Record. 
      - les resx sont déjà là, utilisez-les
      - il manque les traductions des messages d’erreur. 
   - Lorsqu’il y a un dropdown, au lieu de le mettre dans le ViewData ou le ViewBag, faites un ViewModel (RecordViewModel) (ou plueisuers) qui contient les SelectList et les informations du modèle. 
   - Faites un service pour utiliser ce/ces ViewModels.
   - Utilisez le service dans le contrôleur 
   - Traduisez le/les ViewModel que vous avez créé. 
   - Traduisez l’ensemble de la vue Index pour montrez que vous êtes capable d’utiliser un IViewLocalizer.
   - Testez le lien sous le menu « gestion » et les différentes vues.
   - Ajoutez une action qui permet de voir les Record selon un Trainer Record/TrainerIndex(int trainerId). Testez l’icône   

6. BONUS : exécuter le filtre lorsqu’on change n’importe quel paramètre du filtre (au blur)
