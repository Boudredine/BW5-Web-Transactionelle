import CodeBlock from '@theme/CodeBlock';
import CommentCommitPush from '/comment-commit-push.mdx';

# TP1 : JuliePro

## Consignes (15% de la note finale)

- Lisez toutes les instructions et la grille de correction avant de commencer
- Cr√©ez un Repository ``PRIV√â`` et ajoutez votre enseignant comme collaborateur
- Vous **DEVEZ** faire au moins les migrations et les commits demand√©s mais vous pouvez en faire plus sans probl√®me, tant que vous les documentez correctement

## √âtude de cas JuliePro
> Julie Loiselle est propri√©taire de l‚Äôentreprise d‚Äôentrainement personnel JuliePro. L‚Äôentreprise emploi une douzaine d‚Äôentraineurs (**Trainer**) chevronn√©s et sp√©cialis√©s (**Speciality** : perte de poids, alth√©rophilie, course, r√©abilitation, etc).
Un **Trainer** a une seule **Speciality**.
Chaque client (**Customer**) est assign√© √† un **Trainer**.
Le **Trainer** d√©finit √©galement avec son client un objectif courant (**Objective**) : soit de perte de poids ou de distance. Lorsqu‚Äôun **Objective** est atteint, on indique la date.

## Les fonctionnalit√©s √† impl√©menter

- Gestion des sp√©cialit√©s (**Speciality**) avec seedüå±
- Gestion des entraineurs (**Trainer**) et de leur sp√©cialit√© (**Speciality**) avec seedüå±
- Impl√©mentation des r√®gles d'affaire sp√©cifiques
- Utilisation de **vues partielles**
- Utilisation de **FontAwesome**
- Mise en place du mod√®le de donn√©e pour les clients (**Customer**) et de leurs objectifs (**Objective**)

## Cr√©ation du projet
1.	Cr√©ez le Repository ``PRIV√â`` **3W6_TP_NOM_PRENOM** dans GitHub et ajoutez votre enseignant comme collaborateur
2.	Cr√©er une branche √† partir de **Main** et appel√©e la **TP1**.

:::caution

Ne pas travailler directement dans la branche **Main**. Vous devez ajouter une fonctionnalit√© √† la fois.

:::

3.	Cr√©ez un nouveau projet MVC qui se nomme **JuliePro**
4.	Dans le projet MVC:

- Il faut t√©l√©charger ce [fichier zip](/tps/tp1/TP1_FichiersComplementaires.zip) qui contient les images utilis√©es dans le projet et extraire son contenu dans le r√©pertoire **/wwwroot/** de votre projet ()

:::tip

Dites oui pour remplacer **favicon.ico**, **bootstrap.css** et **bootstrap.min.css** (Bootstrap **5.1.0** contient un bug, alors on utilise la version **5.1.1**)

:::

- Modifier le contenu du Layout

import LayoutSource from '!!raw-loader!./_Layout.cshtml';

<details><summary>/Views/Shared/_Layout.cshtml</summary>
<p>
<CodeBlock language="html" title="_Layout.cshtml">{LayoutSource}</CodeBlock>
</p>
</details>

- Modifier le contenu de l'Index

import IndexSource from '!!raw-loader!./Index.cshtml';

<details><summary>/Views/Home/Index.cshtml</summary>
<p>
<CodeBlock language="html" title="Index.cshtml">{IndexSource}</CodeBlock>
</p>
</details>

- Assurez-vous que la page d'accueil de votre application est identique √† celle-ci:

![Image Reference](/tps/tp1/ReferenceProjet.png)

<CommentCommitPush/>

## Gestion des sp√©cialit√©s
1.	Ajout de la classe **Speciality** qui sera g√©rer par Entity Framework Core dans le r√©pertoire **/Data/**

![Image Reference](/tps/tp1/diagrammeSpeciality.png)

```csharp title="Speciality"
public string Name { get; set; }
```

:::info

Il faut ajouter les champs n√©cessaires pour **EFC** et les annotations. R√©f√©rez-vous au diagramme de classes du projet.

:::

3.	G√©n√©ration du contr√¥leur MVC pour la classe **Speciality**
4.	Ajouter un seedüå± pour les sp√©cialit√©s
```csharp title="Seed des sp√©cialit√©s"
builder.Entity<Speciality>().HasData(new Speciality() { Id = 1, Name = "Perte de poids" });
builder.Entity<Speciality>().HasData(new Speciality() { Id = 2, Name = "Course" });
builder.Entity<Speciality>().HasData(new Speciality() { Id = 3, Name = "Alth√©rophilie" });
builder.Entity<Speciality>().HasData(new Speciality() { Id = 4, Name = "R√©habilitation" });
```
5.	Ajoutez une migration et mettez √† jour votre base de donn√©es
6.  Le menu **Admin/Specialities** de la page principale doit nous diriger vers la gestion des sp√©cialit√©s
7.  √Ä ce point, vous devez pouvoir faire les actions **CRUD** de **Speciality**

<CommentCommitPush/>

## Gestion des entraineurs
1.	Ajout de la classe **Trainer** qui sera g√©rer par Entity Framework Core dans le r√©pertoire **/Data/**

![Image Reference](/tps/tp1/diagrammeTrainer.png)

```csharp title="Trainer"
public string FirstName { get; set; }
public string LastName { get; set; }
public string Email { get; set; }
public string Photo { get; set; }
```

:::info

Il faut ajouter les champs n√©cessaires pour **EFC** et les annotations. R√©f√©rez-vous au diagramme de classes du projet.

:::

2.	G√©n√©ration du contr√¥leur MVC pour la classe **Trainer**
3.	Ajouter un seedüå± pour les entraineurs
```csharp title="Seed des entraineurs"
builder.Entity<Trainer>().HasData(new Trainer() { Id = 1, FirstName = "Chrystal", LastName = "Lapierre", TrainerEmail = "Chrystal.lapierre@juliepro.ca", SpecialityId= 1, Photo = ""});
builder.Entity<Trainer>().HasData(new Trainer() { Id = 2, FirstName = "F√©lix", LastName = "Trudeau", TrainerEmail = "Felix.trudeau@juliePro.ca", SpecialityId = 2, Photo = "" });
builder.Entity<Trainer>().HasData(new Trainer() { Id = 3, FirstName = "Fran√ßois", LastName = "Saint-John", TrainerEmail = "Frank.StJohn@juliepro.ca", SpecialityId = 1, Photo = "" });
builder.Entity<Trainer>().HasData(new Trainer() { Id = 4, FirstName = "Jean-Claude", LastName = "Bastien", TrainerEmail = "JC.Bastien@juliepro.ca", SpecialityId = 4, Photo = "" });
builder.Entity<Trainer>().HasData(new Trainer() { Id = 5, FirstName = "Jin Lee", LastName = "Godette", TrainerEmail = "JinLee.godette@juliepro.ca", SpecialityId = 3, Photo = "" });
builder.Entity<Trainer>().HasData(new Trainer() { Id = 6, FirstName = "Karine", LastName = "Lachance", TrainerEmail = "Karine.Lachance@juliepro.ca", SpecialityId = 2, Photo = "" });
builder.Entity<Trainer>().HasData(new Trainer() { Id = 7, FirstName = "Ramone", LastName = "Esteban", TrainerEmail = "Ramone.Esteban@juliepro.ca", SpecialityId = 3, Photo = "" });
```
5.	Ajoutez une migration et mettez √† jour votre base de donn√©es
6.  Le menu **Admin/Trainers** de la page principale doit nous diriger vers la gestion des sp√©cialit√©s

7. üöß Modification de la vue et ajout des entra√Æneurs
   - Liste des Trainers tri√©s par LastName et FirstName
   - Afficher des photos?
   - Speciality dans un dropdown
   - Pour le create de l'entr√¢ineur, on entre simplement le path de la photo pour l'instant

<CommentCommitPush/>

## Impl√©mentation de la logique d'affaire
1. Rendre impossible d‚Äôeffacer une **Speciality** si elle est associ√© √† au moins un **Trainer** et afficher un message appropri√© √† l'utilisateur dans ce cas
2. S'assurer que le delete de **Speciality** fonctionne correctement si il n'est pas utilis√©
3. S'assurer que le delete de **Trainer** fonctionne correctement

<CommentCommitPush/>

## Utilisation des vues partielles et de FontAwesome
1.	üößUtilisez un Partial View pour les boutons de navigations
2.	üößUtilisez FontAwesome pour certain boutons

<CommentCommitPush/>

## Ajout de clients et de leurs objectifs
1.	Mise en place du mod√®le de donn√©e pour les clients (**Customer**) et de leurs objectifs (**Objective**)

![Image Reference](/tps/tp1/diagrammeCustomer.png)

```csharp title="Customer"
public string FirstName { get; set; }
public string LastName { get; set; }
public string Email { get; set; }
public DateTime BirthDate { get; set; }
public double StartWeight { get; set; }
```

![Image Reference](/tps/tp1/diagrammeObjective.png)

```csharp title="Objective"
public string Name { get; set; }
public double LostWeightKg { get; set; }
public double DistanceKm { get; set; }
public DateTime AchievedDate { get; set; }
```

2. Un **Customer** a donc une relation **un √† plusieurs** avec ses **Objective**. La seule chose qui diff√©rencie l'objectif courant, c'est qu'il n'a pas d'**AchievedDate**.
3. Ajouter un seed üå± avec un **Customer** et son **Objective** courant et un **Objective** compl√©t√© et un **Trainer** associ√©.
4. N'oubliez pas d'ajouter votre migration et de mettre √† jour votre base de donn√©es.
5. Une fois que c'est fait, v√©rifiez les donn√©es dans votre base de donn√©es!

<CommentCommitPush/>

:::danger

Une fois que vous avez termin√© votre TP, il est temps de merger votre branche **TP1** dans votre branche **Main**.

:::